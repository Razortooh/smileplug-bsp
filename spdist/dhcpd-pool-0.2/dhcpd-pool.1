.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.32
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "DHCPD-POOL 1"
.TH DHCPD-POOL 1 "2008-04-16" "perl v5.8.8" "User Contributed Perl Documentation"
.SH "NAME"
dhcpd\-pool \- Monitor and report ISC dhcpd pool usage
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
dhcpd-pool [\-c|\-\-config <configfile>] [\-l|\-\-leases <leasefile>]
    [\-m|\-\-munin [\-p|\-\-pool <poolID>] [\-a|\-\-append <string>]]
    [\-n|\-\-nagios] [\-v|\-\-verbose] [\-h|\-\-help]
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
This script will report pool usage on a \s-1ISC\s0 dhcpd server. Does also
work on failover pairs, since each node will have identical config
(when it comes to subnets and pools) and a complete leases file.
Configuration is done in the \s-1DHCP\s0 config file, but the script will
report usage on pools without configuration. Details below.
.PP
The script can operate as a Nagios plugin, reporting pool usage above
the treshold configured by the user. It can also act as a Munin
plugin, creating one graph per pool and/or one graph with all pools.
.PP
\&\fBdhcpd-pool\fR uses a cache file (via Berkeley \s-1DB\s0) to speed up runtime
and decrease load impact on the \s-1DHCP\s0 server. The cache is updated if
it is more than 5 minutes old.
.SH "OPTIONS"
.IX Header "OPTIONS"
.IP "\fB\-c\fR, \fB\-\-config\fR" 4
.IX Item "-c, --config"
The \s-1ISC\s0 dhcpd config file. Normally \fI/etc/dhcpd.conf\fR, which is the
default.
.IP "\fB\-l\fR, \fB\-\-leases\fR" 4
.IX Item "-l, --leases"
The \s-1ISC\s0 dhcpd leases file. Default is \fI/var/db/dhcpd.leases\fR
.IP "\fB\-n\fR, \fB\-\-nagios\fR" 4
.IX Item "-n, --nagios"
Act as a Nagios plugin. Notification limits for each pool, as well as
which pools will be monitored, is configured in the \s-1DHCP\s0 config
file. Details below.
.IP "\fB\-m\fR, \fB\-\-munin\fR" 4
.IX Item "-m, --munin"
Act as a Munin plugin. One can create one graph per pool, or create
one graph with all pools. In case of the latter percentage usage is
graphed instead of absolute usage, since many different pools in one
graph usually don't make sense and is pretty useless.
.IP "\fB\-p\fR, \fB\-\-pool\fR" 4
.IX Item "-p, --pool"
Pool \s-1ID\s0. This option is only used when acting as a Munin plugin. The
pool \s-1ID\s0 has the form \fIsubnet_mask_X\fR where \fIX\fR is the pool number as
found in the \s-1DHCP\s0 config file. Pools declared with \*(L"pool\*(R" starts on 1,
while anonymous pools (without pool declaration) has number 0.
Example: 129.240.202.0_23_1
.IP "\fB\-a\fR, \fB\-\-append\fR" 4
.IX Item "-a, --append"
This is the regular Munin option, i.e. \*(L"config\*(R". Other possibilities
are \*(L"suggest\*(R" and \*(L"autoconf\*(R". This option does only make sense when
the script is used as a Munin plugin.
.IP "\fB\-v\fR, \fB\-\-verbose\fR" 4
.IX Item "-v, --verbose"
Be more verbose. This option has only effect when the script is used
in its default form, i.e. not Nagios or Munin. When this option is
given, the \s-1IP\s0 range for each pool is printed out.
.IP "\fB\-\-cache\-period\fR" 4
.IX Item "--cache-period"
The default timeout (or \s-1TTL\s0) for the cache, given in minutes. The
default cache period is 5 minutes. You may want to increase this if
you're polling less frequently than the default, in which case the
cache has no effect.
.IP "\fB\-h\fR, \fB\-\-help\fR" 4
.IX Item "-h, --help"
Short help text.
.IP "\fB\-\-man\fR" 4
.IX Item "--man"
Display the man page.
.IP "\fB\-\-version\fR" 4
.IX Item "--version"
Display version information
.SH "CONFIGURATION"
.IX Header "CONFIGURATION"
Configuration is done in the \s-1DHCP\s0 config file. For each pool you want
to monitor, include a statement like this in the beginning of each
pool scope:
.PP
# monitor: <warning> <critical> <Y|N> [name]
.PP
Note the comment sign. The limits configuration is a comment in the
\&\s-1DHCP\s0 config, and is only recognized by this script.
.PP
The \fBY\fR or \fBN\fR is simply a yes or no to monitoring. If monitoring is
set to \fBN\fR, the Nagios plugin will ignore the pool.
.PP
The name is optional, but it's encouraged to set a proper name for
each pool.
.PP
The warning and critical limits can each be given in three different
forms. In the examples, if the pool holds 200 leases total, the limits
are effectively identical.
.IP "\fBPercentage\fR" 4
.IX Item "Percentage"
When a percent sign (%) follows the number, the limit is given in
percent. E.g. if the limit is 80% and the pool range contains 200
leases, a notification will occur if the number of active leases is
more than or equal to 160.
.Sp
Example: # monitor: 80% 90% Y My pool
.IP "\fBAbsolute\fR" 4
.IX Item "Absolute"
When the limit is given as a positive integer, a notification will
occur when the number of active leases is greater than or equal to the
limit.
.Sp
Example: # monitor: 160 180 Y My pool
.IP "\fBLeases left\fR" 4
.IX Item "Leases left"
If a minus sign (\-) precedes the number, a notification will occur if
the number of free (not active) leases is less than or equal to the
limit.
.Sp
Example: # monitor: \-40 \-20 Y My pool
.PP
The limit configuration can be set in both the subnet scope and the
pool scope. If set in the pool scope, that takes precedence for that
particular pool. Setting the limits configuration per pool is
recommended.
.SH "FILES"
.IX Header "FILES"
Cache file: \fI/var/cache/dhcpd\-pool/cache.db\fR
.PP
\&\s-1DHCP\s0 config: \fI/etc/dhcpd.conf\fR
.PP
\&\s-1DHCP\s0 leases: \fI/var/db/dhcpd.leases\fR
.SH "SEE ALSO"
.IX Header "SEE ALSO"
Complete documentation: <http://folk.uio.no/trondham/software/dhcpd\-pool.html>
.SH "AUTHOR"
.IX Header "AUTHOR"
Trond H. Amundsen <t.h.amundsen@usit.uio.no>
.SH "BUGS"
.IX Header "BUGS"
Probably.
